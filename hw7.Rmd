---
title: "360hw7"
output: html_document
date: "2024-03-21"
---

# 1

```{r}
#divorce <- read.csv("divorce(Sheet1).csv")

```



### 1c

```{r}
taub2 <- 16
tauc2 <- 16

#x <- divorce$X
#y <- divorce$Y
x <- c(2,0,0,1,0,-1,3,9,0,2,-1,1,6,0,-2,-1,4,2,0,0,3,0,3,12,-3)
y <- c(0,0,0,0,0,0,0,1,0,1,0,1,1,1,1,0,1,1,0,0,1,0,0,1,0)

rcnorm<-function(n,mean=0,sd=1,a=-Inf,b=Inf){
  u<-runif(n, pnorm((a-mean)/sd), pnorm((b-mean)/sd) )
  mean+sd*qnorm(u)
}
```

```{r}
library(coda)
library(tidyverse)
```

```{r}

S <- 100
n <- length(y)

#parameters
param <- NULL

#Z is a vector so store separate
Z <- NULL

#initialize z and c
c = 0
z = ifelse(y==1, rcnorm(n, mean=beta*x, sd=1, a=c), rcnorm(n, mean=beta*x, sd=1, b=c))

a <- (1/taub2) + sum(x*x)

for (s in 1:S){
  

  b = sum(x*z)
  
  #sample beta
  mu = b/a
  beta = rnorm(1, mean = mu, sd = sqrt(1/a))
  
  #sample z
  z = ifelse(y==1, rcnorm(n, mean=beta*x, sd=1, a=c), rcnorm(n, mean=beta*x, sd=1, b=c))
  
  #sample c
  c = rcnorm(1, mean=0, sd=sqrt(tauc2), a=max(z[y == 0]), b=min(z[y == 1]))
  
  #store info
  param = rbind(param, c(beta, c))
  Z = rbind(Z, z)
  
}

effectiveSize(param[,1])
effectiveSize(param[,2])
effectiveSize(Z)

```

# 3

## 3a

```{r}
school1 <- c(2.11,
9.75,
13.88,
11.3,
8.93,
15.66,
16.38,
4.54,
8.86,
11.94,
12.47,
11.11,
11.65,
14.53,
9.61,
7.38,
3.34,
9.06,
9.45,
5.98,
7.44,
8.5,
1.55,
11.45,
9.73)

school2 <- c(0.29,
1.13,
6.52,
11.72,
6.54,
5.63,
14.59,
11.74,
9.12,
9.43,
10.64,
12.28,
9.5,
0.63,
15.35,
5.31,
8.49,
3.04,
3.77,
6.22,
2.14,
6.58,
1.11)

school3 <- c(4.33,
7.77,
4.15,
5.64,
7.69,
5.04,
10.01,
13.43,
13.63,
9.9,
5.72,
5.16,
4.33,
12.9,
11.27,
6.05,
0.95,
6.02,
12.22,
12.85)

school4 <- c(12.46,
6.42,
5.96,
0.92,
11.43,
2.27,
1.54,
6.55,
2.3,
0.57,
7.4,
6.63,
7.02,
2.95,
4.44,
7.78,
8.36,
13.32,
8.81,
2.06,
14.17,
0.88,
10.36,
4.97)

school5 <- c(12.97,
13.6,
13.54,
5.49,
11.52,
8.23,
8.98,
6.42,
12.01,
15.08,
7.16,
10.84,
8.15,
4.27,
14.21,
15.93,
8.99,
10.12,
5.65,
14.94,
14.2,
8.43,
10.18,
17.47)

school6 <- c(2.5,
7.56,
5.79,
4.92,
3.32,
9.65,
2.58,
3.31,
5.47,
6.98,
9.74,
0.97,
6.2,
11.16,
13.45,
7.84,
10.43,
5.85,
5.56,
6.82,
5.23,
1.18)

school7 <- c(7.5,
11.15,
5.82,
0.39,
4.11,
4.82,
13.56,
3.11,
6.69,
7.33,
11.87,
9.14,
0.03,
1.76,
5.03,
3.72,
7.28,
7.15,
9.07,
8.59,
6.53,
0.27)

school8 <- c(6.41,
3.52,
7.65,
9.56,
9.49,
4.54,
14.72,
5.63,
4.24,
8.96,
8.59,
8.69,
6.18,
4.79,
11.67,
2.8,
7.03,
4.32,
11.51,
7.32)
```

```{r}
Y = list()
Y[[1]] <- as.matrix(school1)
Y[[2]] <- as.matrix(school2)
Y[[3]] <- as.matrix(school3)
Y[[4]] <- as.matrix(school4)
Y[[5]] <- as.matrix(school5)
Y[[6]] <- as.matrix(school6)
Y[[7]] <- as.matrix(school7)
Y[[8]] <- as.matrix(school8)
```


